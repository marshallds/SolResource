<html>
<head>
	<title>Sol Resource</title>
	<meta name="viewport" content="user-scalable=no, initial-scale=1, maximum-scale=1, minimum-scale=1, width=device-width, height=device-height, target-densitydpi=device-dpi" />
	<link href='http://fonts.googleapis.com/css?family=Source+Sans+Pro:200,300,400,600,700,900,200italic,300italic,400italic,600italic,700italic,900italic' rel='stylesheet' type='text/css'>
	<style type="text/css">
	@import url(css/interface.css);
	@import url(css/overlay.css);

	svg {
		width:100%;
		height:100%;
	}
	#rangering {
		scale:0;
	}
	#orbit {
		  stroke: rgba(150,150,150,0.6);
		  fill: none;
		  stroke-width: 2;
		  stroke-dasharray: 2,4;
	}
	text.hexValue {
		fill: #fff;
		font-family: euro;
		font-weight: 300;
		font-size: 3em;
		text-anchor:middle;
		alignment-baseline:baseline;
	}
	text.hexLabel {
		font-family:  'Source Sans Pro', sans-serif;
		font-weight: 300;
		fill: #fff;
		font-size: 1.3em;
		text-anchor:middle;
	}

	</style>
</head>
<body>
	<!-- <audio id="music" src="assets/Sounds/redglowingdust.mp3" autoplay></audio> -->
	<!-- <audio id="buttonsound"><source src="assets/Sounds/menuclick.mp3"></source></audio> -->
	<!-- <div id="intro"><video src="assets/Demo1.mp4" poster="assets/a_title.png" autoplay controls preload="true"></video></div> -->
<div id="container">


<div id="overlayMenu">
	<div id="overlayClickZone"></div>
	<nav>
		<ul>
			<li class="active" rel="homeTab">HOME</li>
			<li rel="missionsTab">MISSIONS</li>
			<li rel="logisticsTab">LOGISTICS</li>
		</ul>
	</nav>
	<div id="homeTab" class="active">
		<ul class="minimalList">
			<li><img src="assets/Interface/notificationicon.png">Welcome aboard!
				<div><p>With a couple of repairs the station will be up and running at full capactiy in no time. Keep resources coming to the station, while keeping an eye on the logistics and you'll be fine!</p></div></li>
			<li><img src="assets/Interface/notificationicon.png"><span>Missions</span>A new mission is available </li>
			<li><img src="assets/Interface/notificationicon.png"><span>Logistics</span>Station systems damaged </li>
		</ul>
	</div>
	<div id="missionsTab">
		<div class="mission">
			<h2>Mission One</h2>
			<div>
			<p><span class="yellow">Calibrate</span> the sensors on the Series I probes after traveling to a nearby asteroid field. Additionally, <span class="blue">more resources are needed</span> to begin repairs on logistical systems.</p>
			<!-- <img src="play mission"> -->
			<ul>
				<li>Travel to an asteroid field<span class="right">0/1</span></li>
				<li><span class="yellow">Scan</span> three asteroids<span class="right">0/3</span></li>
				<li><span class="blue">Retrieve</span> two asteroids<span class="right">0/2</span></li>
			</ul></div>
		</div>
	</div>
	<div id="logisticsTab">
		<div id="logisticsTabMain">
			<div id="sensorsButton"></div>
			<div id="addFuelButton"></div>
		</div>
		<div id="sensorsTab">
			<h2>Sensors <span>Rating 1</span></h2>
			<p class="button" id="runsysdiag">run level 1 diagnostic</p>
			<p id="status"><span id="statusbox"></span>SYSTEM<br>status</p>
			<div id="systemsDisplay">
				<p>system status unknown</p>
				<div id="repairbutton">
					<p id="repairbuttontitle">REPAIR</p>
					<p id="repairnote">use resources to perform upkeep repairs before critical systems fail</p>
					<p id="repairrequiredresourceslabels">IRON<br>PLATINUM<br>HYDROGEN</p>
					<p id="repairrequiredresourcesvalues">40<br>25<br>80</p>
					<p id="repairrequiredtime">2:00</p>
				</div>
			</div>
			<div class="button" id="scanbutton"><p>SCAN<span>FUEL: 5%</span></p></div>
			<p class="buttonnote">Use radar to scan the surrounding area for asteroids of note</p>
		</div>
		
	</div>
</div>
<header>
<img src="assets/Interface/powerbutton.png">
<img src="assets/Interface/settingsbutton.png">
<h1>Lunar Orbital Station</h1>
<p id="topStatus">STATUS: <span>DAMAGED</span></p>

	<div id="bumperleft"></div>
	<div id="bumperright"></div>
</header>



<footer>
<h3>FUEL</h3>
<p id="fuelLabel">50%</p>
<div id="fuelbar"><img src="assets/Interface/energyglow.png"></div>
<div id="missionsButton"><p>1</p></div>
<div id="fleetButton"><p>0</p></div>
<div class="resourceBar" style="left:100px"><p>20</p><h3>Hydrogen</h3></div>
<div class="resourceBar" style="left:250px"><p>30</p><h3>Oxygen</h3></div>
<div class="resourceBar" style="left:400px"><p>40</p><h3>Iron</h3></div>
<div class="resourceBar" style="left:550px"><p>10</p><h3>Platinum</h3></div>

</footer>

<div id="notification">
	
</div>

<svg version="1.1" baseProfile="full" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:ev="http://www.w3.org/2001/xml-events" width="100%" height="100%" viewBox="0 0 800 1205">

	<defs>
		<radialGradient id = "blipPulse" cx = "50%" cy = "50%" r = "50%">

			<stop stop-color = "#3ddeed" offset = "0%" stop-opacity = "0.2">
				<animate attributeName="stop-opacity" begin="0s" dur="3s" values="1;0;1" repeatCount="indefinite" />
			</stop>
			<stop stop-color = "#3ddeed" offset = "0%" stop-opacity = "1">
				<animate attributeName="offset" begin="0s" dur="3s" values="0;1;1;0" repeatCount="indefinite" />
				<animate attributeName="stop-opacity" begin="0s" dur="3s" values="0;1;0;0" repeatCount="indefinite" />
			</stop>

			<stop stop-color = "#3ddeed" offset = "2" stop-opacity = "0" />
		</radialGradient>
		<radialGradient id = "resourcePulse" cx = "50%" cy = "50%" r = "50%">
			<stop stop-color = "#3ddeed" offset = "0%" stop-opacity = "1" />
			<stop stop-color = "#3ddeed" offset = "100%" stop-opacity = "0" />
		</radialGradient>
		<g id="blip">
			<circle cx = "0" cy = "0" r = "20" fill = "url(#blipPulse)" stroke = "#3ddeed" stroke-width = "2" opacity="0.3"/>
			<circle cx = "0" cy = "0" r = "7" fill = "#3ddeed" stroke = "none" stroke-width = "0"/>
		</g>
		<g id="hex">
		<path d="m 0 -60 L 52 -30 L 52 30 L 0 60 L -52 30 L -52 -30 L 0 -60" fill="rgba(255,255,255,0.15)" />
</g>
		<radialGradient id = "g1" cx = "50%" cy = "50%" r = "50%">
			<stop stop-color = "#3ddeed" offset = "0%"  stop-opacity = "0"/>
			<stop stop-color = "#3ddeed" offset = "60%" stop-opacity = "0"/>
			<stop stop-color = "#3ddeed" offset = "86%" stop-opacity = "0.1"/>
			<stop stop-color = "#3ddeed" offset = "100%" stop-opacity = "0.25"/>
		</radialGradient>

		<filter id="fearth" x="0%" y="0%" width="100%" height="100%">
			<feImage xlink:href = "assets/earth.png"/>
		</filter>
		<filter id = "fasteroid1" x = "0%" y = "0%" width = "100%" height = "100%">
			<feImage xlink:href = "assets/Asteroids/ice1.png"/>
		</filter>
		<filter id = "fasteroid2" x = "0%" y = "0%" width = "100%" height = "100%">
			<feImage xlink:href = "assets/Asteroids/ice2.png"/>
		</filter>
		<filter id = "fasteroid3" x = "0%" y = "0%" width = "100%" height = "100%">
			<feImage xlink:href = "assets/Asteroids/iron1.png"/>
		</filter>
		<filter id = "fasteroid4" x = "0%" y = "0%" width = "100%" height = "100%">
			<feImage xlink:href = "assets/Asteroids/iron2.png"/>
		</filter>
		<filter id = "ffleetcolor" x = "0%" y = "0%" width = "100%" height = "100%">
			<feImage xlink:href = "assets/Asteroids/fleeticoncolor.png"/>
		</filter>
		<filter id = "ffleetgray" x = "0%" y = "0%" width = "100%" height = "100%">
			<feImage xlink:href = "assets/Asteroids/fleeticongray.png"/>
		</filter>
		<filter id = "fdeployarrow" x = "0%" y = "0%" width = "100%" height = "100%">
			<feImage xlink:href = "assets/Asteroids/deployarrow.png"/>
		</filter>
	</defs>

	<g id="mapcenter" transform="translate(400,600)">
		<g id="map" transform="scale(1) translate(0,0)">
			<circle cx="-800" cy="0" r="800" id="orbit" />
			<circle id="rangering" cx="0" cy="0" r="400" fill="url(#g1)" transform="scale(0)" />
			<g id="blips">
				<use id="loc0" x = "100" y = "150" xlink:href = "#blip" opacity="0" ref="asteroidfield0"/>
				<use id="loc1" x = "-180" y = "110" xlink:href = "#blip" opacity="0" ref="asteroidfield1" />
				<use id="loc2" x = "230" y = "-70" xlink:href = "#blip" opacity="0" ref="asteroidfield2" />
			</g>
			<circle cx="0" cy="0" r="17" fill="blue" filter="url(#fearth)" id="earth" />
			<g class="asteroidfield" id="asteroidfield0" x="100" y="150" transform="translate(100,150) scale(0.05)" opacity="0">
				<circle cx="48" cy="-146" r="25" fill="grey" filter="url(#fasteroid1)" id="asteroid1" />
				<circle cx="-120" cy="-230" r="25" fill="grey" filter="url(#fasteroid2)" id="asteroid2" />
				<circle cx="190" cy="90" r="25" fill="grey" filter="url(#fasteroid3)" id="asteroid3" />
				<circle cx="-277" cy="270" r="25" fill="grey" filter="url(#fasteroid4)" id="asteroid4" />
			</g>
			<g class="asteroidfield" id="asteroidfield1" x="-180" y="110" transform="translate(-180,110) scale(0.05)" opacity="0">
				<circle cx="50" cy="-168" r="25" fill="grey" filter="url(#fasteroid1)" id="asteroid1" />
				<circle cx="-285" cy="222" r="25" fill="grey" filter="url(#fasteroid2)" id="asteroid2" />
				<circle cx="79" cy="171" r="25" fill="grey" filter="url(#fasteroid3)" id="asteroid3" />
				<circle cx="-92" cy="-293" r="25" fill="grey" filter="url(#fasteroid4)" id="asteroid4" />
			</g>
			<g class="asteroidfield" id="asteroidfield2" x="230" y="-70" transform="translate(230,-70) scale(0.05)" opacity="0">
				<circle cx="-31" cy="102" r="25" fill="grey" filter="url(#fasteroid1)" id="asteroid1" />
				<circle cx="192" cy="-46" r="25" fill="grey" filter="url(#fasteroid2)" id="asteroid2" />
				<circle cx="65" cy="-236" r="25" fill="grey" filter="url(#fasteroid3)" id="asteroid3" />
				<circle cx="-89" cy="-95" r="25" fill="grey" filter="url(#fasteroid4)" id="asteroid4" />
			</g>

		</g>
		<g id="asteroidinfo" opacity="0" transform="translate(0,1000)">
			<image id="deployarrow" xlink:href="assets/Asteroids/deployarrow.png" x="-30" y="-105" width="60" height="45" />
			<circle cx="0" cy="-125" r="45" fill="blue" filter="url(#ffleetcolor)" id="fleetcolor" opacity="1" />
			<circle id="resourcesAvailable" cx="0" cy="-0" r="40" fill="url(#blipPulse)" opacity="0"><animate attributeName="r" begin="0s" dur="3s" values="40;45;40" repeatCount="indefinite" /></circle>
			<circle cx="0" cy="0" r="45" fill="blue" filter="url(#ffleetgray)" id="fleetgray" />

			<clipPath id="clockmask">
				<!-- <path d="M 0 45 A 150,150 0 0,0 -150,150" /> -->
				<rect x="-50" y="50" width="100" height="100" />
			</clipPath>
			<!-- <path d="M 0,0 L 0 -45 A 150,150 0 0,0 -150,150" fill="white" stroke-color="red" stroke="2"/> -->

			<!-- <image id="resourceplus" xlink:href="assets/Asteroids/resourceplus.png" x="-21" y="-25" height="49px" width="43px" opacity="0">
				<animate attributeName="opacity" begin="0s" dur="2s" values="0;1;0" begin="indefinite" repeatCount="1" />
				<animate attributeName="y" begin="0s" dur="2s" values="-25;-120" begin="indefinite" repeatCount="1" />
			</image> -->
			
			<circle id="resourcesReady" clip-path="url(#clockmask)" cx="0" cy="-0" r="45" fill="blue" filter="url(#ffleetcolor)" />

			<g id="h2ohex" transform="translate(108,-125)">
				<use xlink:href = "#hex" opacity="1" />
				<text x = "0" y = "0" class="hexValue">60</text>
				<text x = "0" y = "30"  class="hexLabel">H<tspan baseline-shift = "sub" font-size="0.7em">2</tspan>O</text>
			</g>
			<g id="fehex" transform="translate(180,0)">
				<use xlink:href = "#hex" opacity="1" />
				<text x = "0" y = "0" class="hexValue">50</text>
				<text x = "0" y = "30"  class="hexLabel">Fe</text>
			</g>
			<g id="pthex" transform="translate(108,125)">
				<use xlink:href = "#hex" opacity="1" />
				<text x = "0" y = "0" class="hexValue">10</text>
				<text x = "0" y = "30"  class="hexLabel">Pt</text>
			</g>
		</g>
	</g>
</svg>

</div>

<script src="cordova-2.2.0.js"></script>
<script src="video.js"></script>
<script src="js/jquery1.8.3.min.js"></script>
<script type="text/javascript" src="js/jquery.svg.min.js"></script>
<script type="text/javascript" src="js/jquery.svgdom.min.js"></script>
<script type="text/javascript" src="js/jquery.svganim.min.js"></script>
<script type="text/javascript" src="js/interface.js"></script>
<script type="text/javascript">
  $(document).ready(function() {


  	setFuel(0.82);

  	var scanTime = 3000;
  	var sysDiagTime = 5; //seconds
	
	var backgroundPlayer = null;
	var eventPlayer = null;
	var buttonSound = "/android_asset/www/assets/Sounds/menuclick.mp3";
	var introVideo = "file:///android_asset/www/assets/Demo1.mp4";
	var fuelup = "/android_asset/www/assets/Sounds/fuelup.mp3";
	var fueldown = "/android_asset/www/assets/Sounds/fueldown.mp3";
	var gangnam = "/android_asset/www/assets/Sounds/GANGNAMSTYLE.mp3";
	
	document.addEventListener("deviceready", onDeviceReady, false);
	document.addEventListener("pause", pauseGame, false);
	document.addEventListener("resume", resumeGame, false);
	
	function onDeviceReady() {
		playIntroVideo(introVideo);
		//playAudio("/android_asset/www/assets/Sounds/redglowingdust.mp3", backgroundPlayer);
	}
	
	function playIntroVideo(src) {
		//player = new Media(src, onIntroVideoSuccess, onVideoError);
		
		//player.play();
		
		window.plugins.videoPlayer.play(introVideo);
	}
	
	function onIntroVideoSuccess() {
		console.log("Intro Video Success!");
		playAudio("/android_asset/www/assets/Sounds/redglowingdust.mp3", backgroundPlayer);
	}
	
	function onVideoSuccess() {
		console.log("Video Success!");
	}
	
	function onVideoError(error) {
		alert('code: ' + error.code + '\n' + 'message: ' + error.message + '\n');
	}
	
	function pauseGame() {
		if(backgroundPlayer){
			backgroundPlayer.pause();
		}
		if(eventPlayer){
			eventPlayer.pause();
		}
	}
	
	function resumeGame() {
		if(backgroundPlayer){
			backgroundPlayer.play();
		}
	}
	
	function playAudio(src, player) {
		player = new Media(src, onAudioSuccess, onAudioError);
		
		player.play();
	}
	
	function onAudioSuccess() {
		console.log("Audio Success!");
	}
	
	function onAudioError(error) {
		alert('code: ' + error.code + '\n' + 'message: ' + error.message + '\n');
	}

  	$('#scanbutton').on(touchEvent,function() {
  		$('#overlayMenu').toggleClass('active')
  		$('#rangering').animate({svgTransform:"scale(1)"},scanTime,'linear');
  		// $('#rangering use').animate({'opacity':1})
  		$('#blips use').each(function() {
  			var distance = Math.sqrt(Math.pow($(this).attr('x'),2) + Math.pow($(this).attr('y'),2));
  			$(this).delay(distance/400*scanTime).animate({svgOpacity:1},200)

  		})
  	});
  	$('#blips use').on(touchEvent,function() {
  		$('#map').animate({svgTransform:'scale(20) translate(' + -$(this).attr('x') + ',' + -$(this).attr('y') + ')'},3000,'swing')
  		$(this).animate({svgOpacity:0},3500)
  		$('#'+$(this).attr('ref')).animate({svgOpacity:1},3000,'swing')

  	})
  	$('.asteroidfield circle').on(touchEvent, function() {
  		$('#map').animate({svgTransform:'scale(80) translate(' + ( - $(this).parent().attr('x') - $(this).attr('cx')*0.05) + ',' + ( - $(this).parent().attr('y') - $(this).attr('cy')*0.05) + ')'},1000,'swing',function() {
  			$('#asteroidinfo').animate({svgTransform:'translate(0,0)'},0,'swing')
  			$('#asteroidinfo').animate({svgOpacity:1},600,'swing')
  		})
  	})
//   	document.addEventListener("touchstart", function(e){
// 	    $('h1').html(e.touches[0].pageY);

//     e.preventDefault();//Stops the default behavior
// }, false);
  	$('#fleetcolor').on(touchEvent, function() {
  		$('#fleetcolor, #deployarrow').animate({svgOpacity:0},600,'swing',function() {
  		})
		gatherResourcesAnimation(5);
  	})

  	$('#intro video').on('ended pause',function() {
  		$(this).parent().remove()
  	});
  	$('#overlayClickZone').on(touchEvent,function() {
  		$('#overlayMenu').toggleClass('active')
  	});
  	$('#sensorsButton').on(touchEvent,function() {
  		//document.getElementById('buttonsound').play()
		playAudio(buttonSound, eventPlayer);
  		$(this).parent().toggleClass('logisticsActive')
  		$('#sensorsTab').toggleClass('active');
  	});
  	$('#sensorsTab h2').on(touchEvent,function() {
  		//document.getElementById('buttonsound').play()
		playAudio(buttonSound, eventPlayer);
  		$('#logisticsTabMain').toggleClass('logisticsActive')
  		$(this).parent().toggleClass('active');
  	});
  	$('#addFuelButton').on(touchEvent,function() {
  		//document.getElementById('buttonsound').play()
		playAudio(buttonSound, eventPlayer);
  		setFuel(0.92)
  	});

  	$('#overlayMenu nav li').on(touchEvent,function() {
  		//document.getElementById('buttonsound').play()
		playAudio(buttonSound, eventPlayer);
  		$('#overlayMenu li').removeClass('active');
  		$(this).addClass('active');
  		var targetTab = "#" + $(this).attr('rel');
  		// $('#overlayMenu>.active').fadeOut('fast', function() {
  		// 	$(this).removeClass('active');
	  	// 	$(targetTab).fadeIn('fast').addClass('active')
  		// })
  		$('#overlayMenu>.active').removeClass('active');
		$(targetTab).addClass('active');
  	});
  	$('.mission, .minimalList li').on(touchEvent,function() {
  		//document.getElementById('buttonsound').play()
		playAudio(buttonSound, eventPlayer);
  		$(this).toggleClass('active')
  		$(this).find('div').slideToggle(1000);
  	});
	enableRunDiagnostic();
  	$('#fleetButton').on(touchEvent,function() {
  		//document.getElementById('buttonsound').play()
		playAudio(buttonSound, eventPlayer);
  		$('#notification').html('<div id="fleetlist"><div><h3>Available</h3><p><img src="assets/Interface/babyfleeticon.png">class 1 extractor</p></div><div><h3>Deployed</h3><p><img src="assets/Interface/babyfleeticon.png">ice asteroid: K11428</p></div></div>')
  		$('#notification').fadeToggle()
  	});
  	$('#missionsButton,#notification').on(touchEvent,function() {
  		//document.getElementById('buttonsound').play()
		playAudio(buttonSound, eventPlayer);
  		$('#notification').html('')
  		$('#notification').fadeToggle()
  	});

  });
</script>

</body>
</html>